<!DOCTYPE html>
<html lang="vi">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Tr√≤ Ch∆°i SƒÉn Kho B√°u</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Roboto:wght@300;400;500;700;900&display=swap" rel="stylesheet">
    <style>
        body {
            font-family: 'Roboto', sans-serif;
            background-color: #f8ebd4;
            background-image: url("data:image/svg+xml,%3Csvg width='100' height='100' viewBox='0 0 100 100' xmlns='http://www.w3.org/2000/svg'%3E%3Cpath d='M11 18c3.866 0 7-3.134 7-7s-3.134-7-7-7-7 3.134-7 7 3.134 7 7 7zm48 25c3.866 0 7-3.134 7-7s-3.134-7-7-7-7 3.134-7 7 3.134 7 7 7zm-43-7c1.657 0 3-1.343 3-3s-1.343-3-3-3-3 1.343-3 3 1.343 3 3 3zm63 31c1.657 0 3-1.343 3-3s-1.343-3-3-3-3 1.343-3 3 1.343 3 3 3zM34 90c1.657 0 3-1.343 3-3s-1.343-3-3-3-3 1.343-3 3 1.343 3 3 3zm56-76c1.657 0 3-1.343 3-3s-1.343-3-3-3-3 1.343-3 3 1.343 3 3 3zM12 86c2.21 0 4-1.79 4-4s-1.79-4-4-4-4 1.79-4 4 1.79 4 4 4zm28-65c2.21 0 4-1.79 4-4s-1.79-4-4-4-4 1.79-4 4 1.79 4 4 4zm23-11c2.76 0 5-2.24 5-5s-2.24-5-5-5-5 2.24-5 5 2.24 5 5 5zm-6 60c2.21 0 4-1.79 4-4s-1.79-4-4-4-4 1.79-4 4 1.79 4 4 4zm29 22c2.76 0 5-2.24 5-5s-2.24-5-5-5-5 2.24-5 5 2.24 5 5 5zM32 63c2.76 0 5-2.24 5-5s-2.24-5-5-5-5 2.24-5 5 2.24 5 5 5zm57-13c2.76 0 5-2.24 5-5s-2.24-5-5-5-5 2.24-5 5 2.24 5 5 5zm-9-21c1.105 0 2-.895 2-2s-.895-2-2-2-2 .895-2 2 .895 2 2 2zM60 91c1.105 0 2-.895 2-2s-.895-2-2-2-2 .895-2 2 .895 2 2 2zM35 41c1.105 0 2-.895 2-2s-.895-2-2-2-2 .895-2 2 .895 2 2 2zM12 60c1.105 0 2-.895 2-2s-.895-2-2-2-2 .895-2 2 .895 2 2 2z' fill='%23ebd8ba' fill-opacity='0.4' fill-rule='evenodd'/%3E%3C/svg%3E");
            display: flex;
            flex-direction: column;
            align-items: center;
            min-height: 100vh;
        }

        h1,
        h2,
        h3,
        .heading-font {
            font-family: 'Roboto', sans-serif;
            font-weight: 700;
        }

        .treasure-chest {
            transition: transform 0.3s ease, filter 0.3s ease;
        }

        .treasure-chest:hover {
            transform: scale(1.05);
            filter: brightness(1.1);
        }

        .btn {
            transition: all 0.2s ease;
        }

        .btn:hover {
            transform: translateY(-3px);
            box-shadow: 0 10px 15px -3px rgba(0, 0, 0, 0.1), 0 4px 6px -2px rgba(0, 0, 0, 0.05);
        }

        .btn:active {
            transform: translateY(0);
        }

        .question-card {
            transition: all 0.3s ease;
        }

        .question-card:hover:not(.disabled) {
            transform: translateY(-5px);
        }

        .digit-found {
            animation: bounce 0.5s;
        }

        @keyframes bounce {

            0%,
            100% {
                transform: translateY(0);
            }

            50% {
                transform: translateY(-20px);
            }
        }

        .confetti {
            position: absolute;
            width: 10px;
            height: 10px;
            background-color: #fac5b2;
            animation: confetti-fall 3s linear forwards;
        }

        @keyframes confetti-fall {
            0% {
                transform: translateY(-100px) rotate(0deg);
                opacity: 1;
            }

            100% {
                transform: translateY(500px) rotate(360deg);
                opacity: 0;
            }
        }

        .option-btn {
            transition: all 0.2s ease;
        }

        .option-btn:hover:not(.selected):not(:disabled) {
            transform: translateY(-2px);
            box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1);
        }

        .option-btn.selected {
            background-color: #c5755d;
            color: white;
        }

        .text-e17373 {
            color: #e17373;
        }

        .timer-circle {
            stroke-dasharray: 440;
            stroke-dashoffset: 0;
            transform-origin: center;
            transform: rotate(-90deg);
            transition: stroke-dashoffset 1s linear;
        }

        .code-input {
            width: 50px;
            height: 60px;
            font-size: 24px;
            text-align: center;
            border: 2px solid #fac5b2;
            border-radius: 8px;
            margin: 0 4px;
            transition: all 0.2s;
        }

        .code-input:focus {
            border-color: #c5755d;
            outline: none;
            box-shadow: 0 0 0 3px rgba(197, 117, 93, 0.3);
        }

        .shake {
            animation: shake 0.5s;
        }

        @keyframes shake {

            0%,
            100% {
                transform: translateX(0);
            }

            10%,
            30%,
            50%,
            70%,
            90% {
                transform: translateX(-5px);
            }

            20%,
            40%,
            60%,
            80% {
                transform: translateX(5px);
            }
        }

        .main-container {
            max-width: 1200px;
            width: 100%;
            margin: 0 auto;
        }
    </style>
</head>

<body class="min-h-screen">
    <div class="main-container">
        <!-- Home Screen -->
        <div id="home-screen" class="container mx-auto px-4 py-8">
            <div class="text-center mb-8">
                <h1 class="text-4xl md:text-6xl text-c5755d mb-4 font-black">üè¥‚Äç‚ò†Ô∏è Tr√≤ Ch∆°i SƒÉn Kho B√°u üè¥‚Äç‚ò†Ô∏è</h1>
                <p class="text-xl md:text-2xl text-8a5c39 font-medium">T√¨m m√£ b√≠ m·∫≠t v√† m·ªü kh√≥a r∆∞∆°ng kho b√°u!</p>
            </div>

            <div class="max-w-3xl mx-auto bg-white rounded-xl shadow-xl p-6 mb-8">
                <div class="text-center">
                    <button id="start-game-btn"
                        class="btn bg-8a5c39 hover:bg-c5755d text-e17373 text-2xl py-4 px-8 rounded-xl shadow-lg font-bold">
                        B·∫Øt ƒê·∫ßu Cu·ªôc Phi√™u L∆∞u! üöÄ
                    </button>
                </div>
            </div>

            <div class="max-w-3xl mx-auto bg-white rounded-xl shadow-xl p-6">
                <h2 class="text-2xl md:text-3xl text-c5755d mb-4 font-bold">C√°ch Ch∆°i</h2>
                <ul class="list-disc pl-6 space-y-2 text-lg">
                    <li>M·ªói r∆∞∆°ng kho b√°u c√≥ 5 c√¢u h·ªèi tr·∫Øc nghi·ªám</li>
                    <li>Tr·∫£ l·ªùi ƒë√∫ng c√¢u h·ªèi ƒë·ªÉ ki·∫øm ƒëi·ªÉm v√† m·ªü kh√≥a c√°c ch·ªØ s·ªë m√£</li>
                    <li>B·∫°n s·∫Ω bi·∫øt c√°c ch·ªØ s·ªë nh∆∞ng kh√¥ng bi·∫øt v·ªã tr√≠ c·ªßa ch√∫ng</li>
                    <li>S·ª≠ d·ª•ng b·ªô ƒë·∫øm th·ªùi gian 15 gi√¢y ƒë·ªÉ gi√∫p v·ªõi c√°c c√¢u h·ªèi kh√≥</li>
                    <li>C·ªë g·∫Øng m·ªü kh√≥a r∆∞∆°ng v·ªõi m√£ ƒë√∫ng</li>
                    <li>Sau khi t·∫•t c·∫£ c√°c r∆∞∆°ng ƒë∆∞·ª£c m·ªü, ƒë·ªôi c√≥ nhi·ªÅu ƒëi·ªÉm nh·∫•t s·∫Ω th·∫Øng</li>
                </ul>
            </div>
        </div>

        <!-- Chest Selection Screen -->
        <div id="chest-selection" class="container mx-auto px-4 py-8 hidden">
            <div class="text-center mb-8">
                <h1 class="text-4xl md:text-6xl text-c5755d mb-4 font-black">Ch·ªçn M·ªôt R∆∞∆°ng Kho B√°u</h1>
                <p class="text-xl md:text-2xl text-8a5c39 font-medium">M·ªói r∆∞∆°ng ch·ª©a c√°c c√¢u h·ªèi v√† kho b√°u kh√°c nhau!
                </p>
            </div>

            <div class="flex flex-col md:flex-row justify-center items-center gap-8 mb-12">
                <div id="chest-1"
                    class="treasure-chest cursor-pointer bg-white rounded-xl shadow-xl p-6 text-center w-full md:w-1/3 max-w-xs">
                    <div class="relative">
                        <svg class="w-full h-auto" viewBox="0 0 100 80" xmlns="http://www.w3.org/2000/svg">
                            <rect x="10" y="30" width="80" height="50" rx="5" fill="#8a5c39" />
                            <rect x="10" y="30" width="80" height="10" rx="2" fill="#c5755d" />
                            <rect x="15" y="35" width="70" height="40" rx="2" fill="#ebd8ba" />
                            <circle cx="50" cy="30" r="5" fill="#fac5b2" />
                            <rect x="45" y="20" width="10" height="10" fill="#8a5c39" />
                        </svg>
                        <div class="absolute inset-0 flex items-center justify-center">
                            <span class="heading-font text-4xl text-8a5c39 font-black">1</span>
                        </div>
                    </div>
                    <h3 class="text-2xl text-c5755d mt-4 font-bold">Kho B√°u D·ªÖ</h3>
                    <p class="text-8a5c39">100 ƒëi·ªÉm m·ªói c√¢u h·ªèi</p>
                </div>

                <div id="chest-2"
                    class="treasure-chest cursor-pointer bg-white rounded-xl shadow-xl p-6 text-center w-full md:w-1/3 max-w-xs">
                    <div class="relative">
                        <svg class="w-full h-auto" viewBox="0 0 100 80" xmlns="http://www.w3.org/2000/svg">
                            <rect x="10" y="30" width="80" height="50" rx="5" fill="#8a5c39" />
                            <rect x="10" y="30" width="80" height="10" rx="2" fill="#c5755d" />
                            <rect x="15" y="35" width="70" height="40" rx="2" fill="#ebd8ba" />
                            <circle cx="50" cy="30" r="5" fill="#fac5b2" />
                            <rect x="45" y="20" width="10" height="10" fill="#8a5c39" />
                            <circle cx="25" cy="50" r="5" fill="#fac5b2" />
                            <circle cx="75" cy="50" r="5" fill="#fac5b2" />
                        </svg>
                        <div class="absolute inset-0 flex items-center justify-center">
                            <span class="heading-font text-4xl text-8a5c39 font-black">2</span>
                        </div>
                    </div>
                    <h3 class="text-2xl text-c5755d mt-4 font-bold">Kho B√°u Trung B√¨nh</h3>
                    <p class="text-8a5c39">200 ƒëi·ªÉm m·ªói c√¢u h·ªèi</p>
                </div>

                <div id="chest-3"
                    class="treasure-chest cursor-pointer bg-white rounded-xl shadow-xl p-6 text-center w-full md:w-1/3 max-w-xs">
                    <div class="relative">
                        <svg class="w-full h-auto" viewBox="0 0 100 80" xmlns="http://www.w3.org/2000/svg">
                            <rect x="10" y="30" width="80" height="50" rx="5" fill="#8a5c39" />
                            <rect x="10" y="30" width="80" height="10" rx="2" fill="#c5755d" />
                            <rect x="15" y="35" width="70" height="40" rx="2" fill="#ebd8ba" />
                            <circle cx="50" cy="30" r="5" fill="#fac5b2" />
                            <rect x="45" y="20" width="10" height="10" fill="#8a5c39" />
                            <circle cx="25" cy="45" r="5" fill="#c5755d" />
                            <circle cx="75" cy="45" r="5" fill="#c5755d" />
                            <circle cx="25" cy="65" r="5" fill="#c5755d" />
                            <circle cx="75" cy="65" r="5" fill="#c5755d" />
                            <circle cx="50" cy="55" r="8" fill="#fac5b2" />
                        </svg>
                        <div class="absolute inset-0 flex items-center justify-center">
                            <span class="heading-font text-4xl text-8a5c39 font-black">3</span>
                        </div>
                    </div>
                    <h3 class="text-2xl text-c5755d mt-4 font-bold">Kho B√°u Kh√≥</h3>
                    <p class="text-8a5c39">300 ƒëi·ªÉm m·ªói c√¢u h·ªèi</p>
                </div>
            </div>

            <div class="text-center">
                <button id="back-to-home"
                    class="btn bg-c5755d hover:bg-8a5c39 text-e17373 text-xl py-3 px-6 rounded-lg shadow-md font-medium">
                    Quay L·∫°i Trang Ch·ªß üè†
                </button>
            </div>
        </div>

        <!-- Game Screen -->
        <div id="game-screen" class="container mx-auto px-4 py-8 hidden">
            <div class="text-center mb-8">
                <h1 id="chest-title" class="text-4xl md:text-6xl text-c5755d mb-4 font-black">R∆∞∆°ng Kho B√°u #1</h1>
                <p id="chest-subtitle" class="text-xl md:text-2xl text-8a5c39 font-medium">Tr·∫£ l·ªùi c√¢u h·ªèi ƒë·ªÉ t√¨m m√£ b√≠
                    m·∫≠t!</p>
            </div>

            <div class="grid grid-cols-1 md:grid-cols-3 gap-8">
                <!-- Left Column - Questions -->
                <div class="md:col-span-2">
                    <div class="bg-white rounded-xl shadow-xl p-6 mb-6">
                        <h2 class="text-2xl text-c5755d mb-4 font-bold">C√¢u H·ªèi</h2>
                        <div id="questions-container" class="grid grid-cols-1 gap-4">
                            <!-- Questions will be added here -->
                        </div>
                    </div>

                    <div id="question-detail" class="bg-white rounded-xl shadow-xl p-6 mb-6 hidden">
                        <div class="flex justify-between items-center mb-4">
                            <button id="back-to-questions"
                                class="btn bg-8a5c39 hover:bg-c5755d text-e17373 text-lg py-2 px-4 rounded-lg shadow-md font-medium">
                                ‚Üê Quay L·∫°i C√¢u H·ªèi
                            </button>

                            <div class="flex items-center">
                                <div class="relative w-12 h-12 mr-2">
                                    <svg class="w-12 h-12" viewBox="0 0 160 160">
                                        <circle cx="80" cy="80" r="70" fill="none" stroke="#ebd8ba" stroke-width="12" />
                                        <circle id="timer-circle" class="timer-circle" cx="80" cy="80" r="70"
                                            fill="none" stroke="#c5755d" stroke-width="12" />
                                    </svg>
                                    <span id="timer-text"
                                        class="absolute inset-0 flex items-center justify-center text-xl font-bold">15</span>
                                </div>
                                <button id="start-timer"
                                    class="btn bg-fac5b2 hover:bg-c5755d text-e17373 text-lg py-2 px-4 rounded-lg shadow-md font-medium">
                                    B·∫Øt ƒê·∫ßu ƒê·∫øm Gi·ªù
                                </button>
                            </div>
                        </div>

                        <div class="mb-6">
                            <div class="flex justify-between items-center mb-2">
                                <h3 id="current-question-title" class="text-2xl text-c5755d font-bold">C√¢u H·ªèi</h3>
                                <span id="question-points"
                                    class="bg-8a5c39 text-e17373 px-3 py-1 rounded-lg text-lg font-medium">100
                                    ƒëi·ªÉm</span>
                            </div>
                            <p id="current-question-text" class="text-xl mb-6">N·ªôi dung c√¢u h·ªèi ·ªü ƒë√¢y?</p>
                        </div>

                        <div id="answer-options" class="grid grid-cols-1 md:grid-cols-2 gap-4 mb-6">
                            <!-- Answer options will be added here -->
                        </div>

                        <div class="text-center">
                            <button id="check-answer"
                                class="btn bg-c5755d hover:bg-8a5c39 text-e17373 text-xl py-3 px-6 rounded-lg shadow-md font-bold">
                                Ki·ªÉm Tra ƒê√°p √Ån ‚úì
                            </button>
                        </div>

                        <div id="answer-result" class="mt-6 hidden">
                            <div id="correct-answer"
                                class="bg-green-100 border-l-4 border-green-500 text-green-700 p-4 rounded mb-4 hidden">
                                <p class="text-xl">‚úÖ Ch√≠nh x√°c! B·∫°n ƒë√£ t√¨m th·∫•y m·ªôt ch·ªØ s·ªë: <span id="found-digit"
                                        class="text-3xl font-bold digit-found">5</span></p>
                                <p>B·∫°n ƒë√£ ki·∫øm ƒë∆∞·ª£c <span id="points-earned" class="font-bold">100</span> ƒëi·ªÉm!</p>
                            </div>

                            <div id="wrong-answer"
                                class="bg-red-100 border-l-4 border-red-500 text-red-700 p-4 rounded mb-4 hidden">
                                <p class="text-xl">‚ùå R·∫•t ti·∫øc, ƒë√°p √°n kh√¥ng ƒë√∫ng.</p>
                                <p>H√£y th·ª≠ c√¢u h·ªèi kh√°c!</p>
                            </div>

                            <button id="continue-after-answer"
                                class="btn bg-8a5c39 hover:bg-c5755d text-e17373 text-xl py-3 px-6 rounded-lg shadow-md font-medium">
                                Ti·∫øp T·ª•c
                            </button>
                        </div>
                    </div>
                </div>

                <!-- Right Column - Code -->
                <div>
                    <div class="bg-white rounded-xl shadow-xl p-6 mb-6">
                        <h2 class="text-2xl text-c5755d mb-4 font-bold">M√£ B√≠ M·∫≠t</h2>
                        <div class="flex justify-center mb-6">
                            <div id="code-display" class="grid grid-cols-5 gap-2 w-full">
                                <div
                                    class="bg-ebd8ba rounded-lg h-16 flex items-center justify-center text-3xl font-bold">
                                    ?</div>
                                <div
                                    class="bg-ebd8ba rounded-lg h-16 flex items-center justify-center text-3xl font-bold">
                                    ?</div>
                                <div
                                    class="bg-ebd8ba rounded-lg h-16 flex items-center justify-center text-3xl font-bold">
                                    ?</div>
                                <div
                                    class="bg-ebd8ba rounded-lg h-16 flex items-center justify-center text-3xl font-bold">
                                    ?</div>
                                <div
                                    class="bg-ebd8ba rounded-lg h-16 flex items-center justify-center text-3xl font-bold">
                                    ?</div>
                            </div>
                        </div>

                        <!-- Digits Found section -->
                        <div class="mb-6">
                            <h3 class="text-xl text-c5755d mb-4 font-medium">Ch·ªØ S·ªë ƒê√£ T√¨m Th·∫•y:</h3>
                            <div id="digits-found" class="flex flex-wrap justify-center gap-2">
                                <p class="text-center text-gray-500">Ch∆∞a t√¨m th·∫•y ch·ªØ s·ªë n√†o</p>
                            </div>
                        </div>

                        <div class="mb-6">
                            <h3 class="text-xl text-c5755d mb-4 font-medium">Nh·∫≠p M√£ ƒê·ªÉ M·ªü Kh√≥a:</h3>
                            <div class="flex justify-center mb-4" id="code-input-container">
                                <input type="number" min="0" max="9" class="code-input" maxlength="1">
                                <input type="number" min="0" max="9" class="code-input" maxlength="1">
                                <input type="number" min="0" max="9" class="code-input" maxlength="1">
                                <input type="number" min="0" max="9" class="code-input" maxlength="1">
                                <input type="number" min="0" max="9" class="code-input" maxlength="1">
                            </div>

                            <div class="text-center">
                                <button id="unlock-chest-btn"
                                    class="btn bg-c5755d hover:bg-8a5c39 text-e17373 text-xl py-3 px-6 rounded-lg shadow-md font-bold">
                                    üîì M·ªü Kh√≥a R∆∞∆°ng
                                </button>
                            </div>
                        </div>
                    </div>

                    <div class="text-center">
                        <button id="back-to-chests"
                            class="btn bg-c5755d hover:bg-8a5c39 text-e17373 text-xl py-3 px-6 rounded-lg shadow-md font-medium">
                            Quay L·∫°i R∆∞∆°ng üè†
                        </button>
                    </div>
                </div>
            </div>
        </div>

        <!-- Chest Unlocked Modal -->
        <div id="chest-unlocked-modal"
            class="fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 hidden">
            <div class="bg-white rounded-xl shadow-2xl p-8 max-w-lg w-full mx-4">
                <div class="text-center">
                    <h2 class="text-3xl text-c5755d mb-4 font-black">üéâ ƒê√£ M·ªü Kh√≥a R∆∞∆°ng Kho B√°u! üéâ</h2>
                    <div class="mb-6">
                        <svg class="w-48 h-auto mx-auto" viewBox="0 0 100 80" xmlns="http://www.w3.org/2000/svg">
                            <rect x="10" y="30" width="80" height="50" rx="5" fill="#8a5c39" />
                            <rect x="10" y="15" width="80" height="15" rx="2" fill="#c5755d" />
                            <rect x="15" y="35" width="70" height="40" rx="2" fill="#fac5b2" />
                            <circle cx="25" cy="45" r="5" fill="#ebd8ba" />
                            <circle cx="75" cy="45" r="5" fill="#ebd8ba" />
                            <circle cx="25" cy="65" r="5" fill="#ebd8ba" />
                            <circle cx="75" cy="65" r="5" fill="#ebd8ba" />
                            <circle cx="50" cy="55" r="10" fill="#ebd8ba" />
                        </svg>
                    </div>
                    <p class="text-xl mb-4 font-medium">B·∫°n ƒë√£ m·ªü kh√≥a r∆∞∆°ng!</p>
                    <p class="text-lg mb-6">B·∫°n ƒë√£ ki·∫øm ƒë∆∞·ª£c <span id="chest-points" class="font-bold">500</span> ƒëi·ªÉm
                        th∆∞·ªüng!</p>
                    <button id="continue-after-unlock"
                        class="btn bg-c5755d hover:bg-8a5c39 text-e17373 text-xl py-3 px-6 rounded-lg shadow-md font-bold">
                        Ti·∫øp T·ª•c Cu·ªôc Phi√™u L∆∞u
                    </button>
                </div>
            </div>
        </div>

        <!-- Wrong Code Modal -->
        <div id="wrong-code-modal"
            class="fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 hidden">
            <div class="bg-white rounded-xl shadow-2xl p-8 max-w-lg w-full mx-4">
                <div class="text-center">
                    <h2 class="text-3xl text-red-600 mb-4 font-black">‚ùå M√£ Kh√¥ng ƒê√∫ng!</h2>
                    <p class="text-xl mb-6 font-medium">H√£y th·ª≠ l·∫°i v·ªõi m·ªôt t·ªï h·ª£p kh√°c.</p>
                    <button id="try-again-btn"
                        class="btn bg-c5755d hover:bg-8a5c39 text-e17373 text-xl py-3 px-6 rounded-lg shadow-md font-bold">
                        Th·ª≠ L·∫°i
                    </button>
                </div>
            </div>
        </div>

        <!-- Final Results Modal -->
        <div id="final-results-modal"
            class="fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 hidden">
            <div class="bg-white rounded-xl shadow-2xl p-8 max-w-lg w-full mx-4">
                <div class="text-center">
                    <h2 class="text-3xl text-c5755d mb-4 font-black">üèÜ Ho√†n Th√†nh Cu·ªôc Phi√™u L∆∞u! üèÜ</h2>
                    <p class="text-xl mb-6 font-medium">T·∫•t c·∫£ c√°c r∆∞∆°ng kho b√°u ƒë√£ ƒë∆∞·ª£c m·ªü kh√≥a!</p>

                    <div class="mb-6">
                        <h3 class="text-2xl text-8a5c39 mb-4 font-bold">ƒêi·ªÉm S·ªë Cu·ªëi C√πng</h3>
                        <p class="text-4xl font-black" id="final-score">1500 ƒëi·ªÉm</p>
                    </div>

                    <button id="play-again-btn"
                        class="btn bg-c5755d hover:bg-8a5c39 text-e17373 text-xl py-3 px-6 rounded-lg shadow-md font-bold">
                        Ch∆°i L·∫°i! üîÑ
                    </button>
                </div>
            </div>
        </div>
        <!-- Audio elements (placeholders) -->
        <!-- You will need to add the actual audio files later -->
        <div class="hidden" bis_skin_checked="1">
            <!-- Timer button sound -->
            <audio id="timerSound">
                <!-- Add your timer sound file here -->
                <source src="15s.m4a" type="audio/mpeg">
            </audio>

            <!-- Correct sound -->
            <audio id="correctSound">
                <!-- Add your correct sound file here -->
                <source src="dung.m4a" type="audio/mpeg">
            </audio>

            <!-- Incorrect sound -->
            <audio id="incorrectSound">
                <!-- Add your incorrect sound file here -->
                <source src="sai.m4a" type="audio/mpeg">
            </audio>

            <!-- Star sound -->
            <audio id="starSound">
                <!-- Add your star sound file here -->
                <source src="modau.m4a" type="audio/mpeg">
            </audio>

            <!-- Hope Star selection sound -->
            <audio id="hopeStarSound">
                <!-- Add your hope star selection sound file here -->
                <source src="ngoisaohyvong.m4a" type="audio/mpeg">
            </audio>
            <audio id="selectQues">
                <!-- Add your hope star selection sound file here -->
                <source src="choncauhoi.m4a" type="audio/mpeg">
            </audio>
        </div>
    </div>

    <script>
        // Game data
        const gameData = {
            score: 0,
            currentChest: null,
            digitsFound: [],
            chests: [
                {
                    id: 1,
                    name: "Kho B√°u D·ªÖ",
                    pointsPerQuestion: 100,
                    bonusPoints: 500,
                    code: [2, 5, 7, 3, 0], // Fixed code for chest 1
                    questions: [
                        {
                            id: 1,
                            text: "T·∫°i sao Ch√∫a Gi√™su l·∫°i l√™n n√∫i m·ªôt m√¨nh sau khi gi·∫£i t√°n d√¢n ch√∫ng?",
                            type: "multiple",
                            options: ["V√¨ mu·ªën tr√°nh ƒë√°m ƒë√¥ng", "V√¨ Ng√†i bu·ªìn b√£", "V√¨ mu·ªën c·∫ßu nguy·ªán v·ªõi Ch√∫a Cha", "V√¨ c√°c m√¥n ƒë·ªá kh√¥ng ƒëi c√πng"],
                            answer: 2,
                            answered: false
                        },
                        {
                            id: 2,
                            text: "Trong khi c√°c m√¥n ƒë·ªá l√™n thuy·ªÅn, Ch√∫a Gi√™su ƒë√£ l√†m g√¨?",
                            type: "multiple",
                            options: ["Xu·ªëng thuy·ªÅn c√πng c√°c √¥ng", "Tr·ªü v·ªÅ l√†ng", "L√™n n√∫i c·∫ßu nguy·ªán m·ªôt m√¨nh", "N√≥i chuy·ªán v·ªõi d√¢n ch√∫ng"],
                            answer: 2,
                            answered: false
                        },
                        {
                            id: 3,
                            text: "Khi c√°c m√¥n ƒë·ªá g·∫∑p s√≥ng gi√≥, thuy·ªÅn ƒë√£ ra xa b·ªù bao nhi√™u?",
                            type: "multiple",
                            options: ["M·∫•y c√¢y s·ªë", "M·ªôt c√¢y s·ªë", "V√†i m√©t", "G·∫ßn t·ªõi b·ªù b√™n kia"],
                            answer: 0,
                            answered: false
                        },
                        {
                            id: 4,
                            text: "Th·ªùi ƒëi·ªÉm Ch√∫a Gi√™su ƒëi tr√™n m·∫∑t bi·ªÉn l√† khi n√†o?",
                            type: "multiple",
                            options: ["L√∫c s√°ng s·ªõm", "Canh hai", "Canh ba", "Canh t∆∞"],
                            answer: 3,
                            answered: false
                        },
                        {
                            id: 5,
                            text: "Khi th·∫•y ƒê·ª©c Gi√™su ƒëi tr√™n m·∫∑t bi·ªÉn, c√°c m√¥n ƒë·ªá ph·∫£n ·ª©ng th·∫ø n√†o?",
                            type: "multiple",
                            options: ["M·ª´ng r·ª°", "Ng·∫°c nhi√™n", "C·∫ßu nguy·ªán", "Ho·∫£ng h·ªët v√† t∆∞·ªüng l√† ma"],
                            answer: 3,
                            answered: false
                        }
                    ],
                    completed: false
                },
                {
                    id: 2,
                    name: "Kho B√°u Trung B√¨nh",
                    pointsPerQuestion: 200,
                    bonusPoints: 1000,
                    code: [1, 8, 9, 4, 3], // Fixed code for chest 2
                    questions: [
                        {
                            id: 1,
                            text: "Ch√∫a Gi√™su ƒë√£ n√≥i g√¨ ƒë·ªÉ tr·∫•n an c√°c m√¥n ƒë·ªá?",
                            type: "multiple",
                            options: ["Th·∫ßy ƒë·∫øn c·ª©u c√°c con", "C·ª© y√™n t√¢m, ch√≠nh Th·∫ßy ƒë√¢y, ƒë·ª´ng s·ª£!", "ƒê·ª´ng s·ª£, h√£y c·∫ßu nguy·ªán", "ƒê√¢y l√† th·ª≠ th√°ch c·ªßa c√°c con"],
                            answer: 1,
                            answered: false
                        },
                        {
                            id: 2,
                            text: "Ai l√† ng∆∞·ªùi xin ƒëi tr√™n m·∫∑t n∆∞·ªõc ƒë·∫øn v·ªõi Ch√∫a Gi√™su?",
                            type: "multiple",
                            options: ["ƒê·ª©c Gi√°o Ho√†ng Leo", "Cha Ti·ªÅm", "Ph√™r√¥", "Gioan"],
                            answer: 2,
                            answered: false
                        },
                        {
                            id: 3,
                            text: "Khi Ph√™r√¥ b·∫Øt ƒë·∫ßu ch√¨m xu·ªëng, √¥ng ƒë√£ n√≥i g√¨?",
                            type: "multiple",
                            options: ["Th·∫ßy ∆°i, c·ª©u con v·ªõi!", "Th·∫ßy L·ªôc Fuho ∆°i, c·ª©u con v·ªõi", "L·∫°y Th·∫ßy, con s·ª£ qu√°!", "Con kh√¥ng th·ªÉ ti·∫øp t·ª•c n·ªØa!"],
                            answer: 0,
                            answered: false
                        },
                        {
                            id: 4,
                            text: "ƒêi·ªÅu g√¨ khi·∫øn Ph√™r√¥ b·∫Øt ƒë·∫ßu ch√¨m?",
                            type: "multiple",
                            options: ["V√¨ anh L·ªôc ƒë·∫πp trai", "V√¨ √¥ng nghi ng·ªù v√† s·ª£ h√£i", "V√¨ s√≥ng l·ªõn", "V√¨ Ch√∫a r√∫t tay l·∫°i"],
                            answer: 1,
                            answered: false
                        },
                        {
                            id: 5,
                            text: "ƒê·ª©c Gi√™su ƒë√£ l√†m g√¨ khi Ph√™r√¥ ch√¨m xu·ªëng n∆∞·ªõc?",
                            type: "multiple",
                            options: ["Nh√¨n √¥ng v√† m·ªâm c∆∞·ªùi", "K√™u g·ªçi c√°c m√¥n ƒë·ªá gi√∫p", "Tr·ªü l·∫°i thuy·ªÅn m·ªôt m√¨nh", "ƒê∆∞a tay n·∫Øm l·∫•y √¥ng"],
                            answer: 3,
                            answered: false
                        }
                    ],
                    completed: false
                },
                {
                    id: 3,
                    name: "Kho B√°u Kh√≥",
                    pointsPerQuestion: 300,
                    bonusPoints: 1500,
                    code: [5, 0, 4, 6, 9], // Fixed code for chest 3
                    questions: [
                        {
                            id: 1,
                            text: "Ch√∫a Gi√™su n√≥i g√¨ v·ªõi Ph√™r√¥ khi c·ª©u √¥ng?",
                            type: "multiple",
                            options: ["Con c·∫ßn t·∫≠p luy·ªán th√™m", "Sao l·∫°i ho√†i nghi?", "H√£y h·ªçc n∆°i Th·∫ßy", "ƒê·ª©c tin con m·∫°nh m·∫Ω l·∫Øm!"],
                            answer: 1,
                            answered: false
                        },
                        {
                            id: 2,
                            text: "Khi Ch√∫a Gi√™su v√† Ph√™r√¥ l√™n thuy·ªÅn, ƒëi·ªÅu g√¨ x·∫£y ra?",
                            type: "multiple",
                            options: ["Anh L·ªôc ƒë·∫πp trai h∆°n", "Gi√≥ l·∫∑ng ngay", "M·ªçi ng∆∞·ªùi la h√©t", "A v√† B ƒë√∫ng"],
                            answer: 1,
                            answered: false
                        },
                        {
                            id: 3,
                            text: "C√°c m√¥n ƒë·ªá ƒë√£ th·ªët l√™n ƒëi·ªÅu g√¨ sau khi ch·ª©ng ki·∫øn s·ª± vi·ªác?",
                            type: "multiple",
                            options: ["Ch√∫ng ta ƒë√£ tho√°t ch·∫øt r·ªìi!", "Th·∫ßy l√† ng∆∞·ªùi quy·ªÅn nƒÉng!", "Th·∫≠t l√† k·ª≥ di·ªáu!", "Qu·∫£ th·∫≠t, Ng√†i l√† Con Thi√™n Ch√∫a!"],
                            answer: 3,
                            answered: false
                        },
                        {
                            id: 4,
                            text: "Ph√™r√¥ ƒë√£ ƒëi ƒë∆∞·ª£c tr√™n m·∫∑t n∆∞·ªõc m·ªôt ƒëo·∫°n tr∆∞·ªõc khi b·ªã ch√¨m.",
                            type: "true-false",
                            options: ["ƒê√∫ng", "Sai"],
                            answer: 0,
                            answered: false
                        },
                        {
                            id: 5,
                            text: "C√°c m√¥n ƒë·ªá ngay l·∫≠p t·ª©c nh·∫≠n ra Ch√∫a Gi√™su khi Ng∆∞·ªùi ƒëi tr√™n m·∫∑t bi·ªÉn.",
                            type: "true-false",
                            options: ["ƒê√∫ng", "Sai"],
                            answer: 1,
                            answered: false
                        }
                    ],
                    completed: false
                }
            ]
        };

        // DOM Elements
        const homeScreen = document.getElementById('home-screen');
        const chestSelection = document.getElementById('chest-selection');
        const gameScreen = document.getElementById('game-screen');
        const chestUnlockedModal = document.getElementById('chest-unlocked-modal');
        const wrongCodeModal = document.getElementById('wrong-code-modal');
        const finalResultsModal = document.getElementById('final-results-modal');

        // Home Screen Elements
        const startGameBtn = document.getElementById('start-game-btn');

        // Chest Selection Elements
        const chest1 = document.getElementById('chest-1');
        const chest2 = document.getElementById('chest-2');
        const chest3 = document.getElementById('chest-3');
        const backToHome = document.getElementById('back-to-home');

        // Game Screen Elements
        const chestTitle = document.getElementById('chest-title');
        const chestSubtitle = document.getElementById('chest-subtitle');
        const questionsContainer = document.getElementById('questions-container');
        const questionDetail = document.getElementById('question-detail');
        const backToQuestions = document.getElementById('back-to-questions');
        const currentQuestionTitle = document.getElementById('current-question-title');
        const currentQuestionText = document.getElementById('current-question-text');
        const questionPoints = document.getElementById('question-points');
        const answerOptions = document.getElementById('answer-options');
        const checkAnswer = document.getElementById('check-answer');
        const answerResult = document.getElementById('answer-result');
        const correctAnswer = document.getElementById('correct-answer');
        const wrongAnswer = document.getElementById('wrong-answer');
        const foundDigit = document.getElementById('found-digit');
        const pointsEarned = document.getElementById('points-earned');
        const continueAfterAnswer = document.getElementById('continue-after-answer');
        const codeDisplay = document.getElementById('code-display');
        const codeInputs = document.querySelectorAll('.code-input');
        const digitsFound = document.getElementById('digits-found');
        const unlockChestBtn = document.getElementById('unlock-chest-btn');
        const backToChests = document.getElementById('back-to-chests');
        const timerCircle = document.getElementById('timer-circle');
        const timerText = document.getElementById('timer-text');
        const startTimer = document.getElementById('start-timer');
        const tryAgainBtn = document.getElementById('try-again-btn');

        // Chest Unlocked Modal Elements
        const chestPoints = document.getElementById('chest-points');
        const continueAfterUnlock = document.getElementById('continue-after-unlock');

        // Final Results Modal Elements
        const finalScore = document.getElementById('final-score');
        const playAgainBtn = document.getElementById('play-again-btn');

        // Timer variables
        let timerInterval;
        let timeLeft = 15;
        let timerRunning = false;

        // Audio elements
        const timerSound = document.getElementById('timerSound');
        const correctSound = document.getElementById('correctSound');
        const incorrectSound = document.getElementById('incorrectSound');
        const starSound = document.getElementById('starSound');
        const hopeStarSound = document.getElementById('hopeStarSound');
        const selectQues = document.getElementById('selectQues');

        // Sound functions
        function playTimerSound() {
            try {
                timerSound.currentTime = 0;
                timerSound.play();
            } catch (e) {
                console.log("Timer sound not available yet");
            }

            console.log("Playing timer sound");
        }

        function playQuestionSelectSound() {
            try {
                selectQues.currentTime = 0;
                selectQues.play();
            } catch (e) {
                console.log("Timer sound not available yet");
            }

            console.log("Playing question select sound");
        }

        function playCheckAnswerSound() {
            try {
                correctSound.currentTime = 0;
                correctSound.play();
            } catch (e) {
                console.log("Timer sound not available yet");
            }

            console.log("Playing check answer sound");
        }

        function playCorrectCodeSound() {
            try {
                correctSound.currentTime = 0;
                correctSound.play();
            } catch (e) {
                console.log("Timer sound not available yet");
            }

            console.log("Playing correct code sound");
        }

        function playWrongCodeSound() {
            try {
                incorrectSound.currentTime = 0;
                incorrectSound.play();
            } catch (e) {
                console.log("Timer sound not available yet");
            }

            console.log("Playing wrong code sound");
        }

        function playSelectChestSound() {
            try {
                hopeStarSound.currentTime = 0;
                hopeStarSound.play();
            } catch (e) {
                console.log("Timer sound not available yet");
            }

            console.log("Playing wrong code sound");
        }

        function loadChest(chestId) {
            playSelectChestSound();
            gameData.currentChest = gameData.chests.find(chest => chest.id === chestId);

            // Update UI
            chestTitle.textContent = `R∆∞∆°ng Kho B√°u #${chestId}`;
            chestSubtitle.textContent = `${gameData.currentChest.name} - ${gameData.currentChest.pointsPerQuestion} ƒëi·ªÉm m·ªói c√¢u h·ªèi`;

            // Reset digits found for this chest
            gameData.digitsFound = [];

            // Load questions
            loadQuestions();

            // Reset code display
            resetCodeDisplay();

            // Reset code inputs
            resetCodeInputs();

            // Update digits found display
            updateDigitsFound();

            // Show game screen
            chestSelection.classList.add('hidden');
            gameScreen.classList.remove('hidden');
        }

        function loadQuestions() {
            questionsContainer.innerHTML = '';

            gameData.currentChest.questions.forEach(question => {
                const questionCard = document.createElement('div');
                questionCard.className = `question-card p-4 rounded-lg shadow-md ${question.answered ? 'bg-gray-200 disabled' : 'bg-white hover:bg-fac5b2 hover:bg-opacity-20 cursor-pointer'}`;
                questionCard.dataset.questionId = question.id;

                questionCard.innerHTML = `
                    <div class="flex items-center justify-between">
                        <div class="flex items-center">
                            <div class="w-10 h-10 rounded-full bg-ebd8ba flex items-center justify-center text-lg font-bold mr-3">
                                ${question.id}
                            </div>
                            <div>
                                <h3 class="text-lg font-bold">C√¢u H·ªèi ${question.id}</h3>
                                <p class="${question.answered ? 'text-gray-500' : 'text-8a5c39'}">
                                    ${question.answered ? 'ƒê√£ tr·∫£ l·ªùi' : 'Nh·∫•n ƒë·ªÉ tr·∫£ l·ªùi'}
                                </p>
                            </div>
                        </div>
                        <div class="bg-8a5c39 text-e17373 px-3 py-1 rounded-lg">
                            ${gameData.currentChest.pointsPerQuestion} ƒëi·ªÉm
                        </div>
                    </div>
                `;

                if (!question.answered) {
                    questionCard.addEventListener('click', () => {
                        playQuestionSelectSound(); // Play sound when selecting a question
                        showQuestion(question);
                    });
                }

                questionsContainer.appendChild(questionCard);
            });
        }

        function showQuestion(question) {
            // Update question detail
            currentQuestionTitle.textContent = `C√¢u H·ªèi ${question.id}`;
            currentQuestionText.textContent = question.text;
            questionPoints.textContent = `${gameData.currentChest.pointsPerQuestion} ƒëi·ªÉm`;

            // Reset timer
            resetTimer();

            // Load answer options
            loadAnswerOptions(question);

            // Hide answer result
            answerResult.classList.add('hidden');
            correctAnswer.classList.add('hidden');
            wrongAnswer.classList.add('hidden');

            // Show check answer button
            checkAnswer.classList.remove('hidden');

            // Set current question
            checkAnswer.dataset.questionId = question.id;

            // Show question detail
            questionsContainer.parentElement.classList.add('hidden');
            questionDetail.classList.remove('hidden');
        }

        function loadAnswerOptions(question) {
            answerOptions.innerHTML = '';

            question.options.forEach((option, index) => {
                const optionBtn = document.createElement('button');
                optionBtn.className = 'option-btn w-full p-4 text-left text-lg border-2 border-fac5b2 rounded-lg hover:bg-fac5b2 hover:bg-opacity-20';
                optionBtn.dataset.index = index;

                if (question.type === 'multiple') {
                    optionBtn.innerHTML = `
                        <span class="inline-block w-8 h-8 rounded-full bg-ebd8ba text-center mr-2">${String.fromCharCode(65 + index)}</span>
                        ${option}
                    `;
                } else {
                    optionBtn.innerHTML = `
                        <span class="inline-block w-8 h-8 rounded-full bg-ebd8ba text-center mr-2">${index === 0 ? 'ƒê' : 'S'}</span>
                        ${option}
                    `;
                }

                optionBtn.addEventListener('click', () => {
                    // Remove selected class from all options
                    document.querySelectorAll('.option-btn').forEach(btn => {
                        btn.classList.remove('selected');
                    });

                    // Add selected class to clicked option
                    optionBtn.classList.add('selected');
                });

                answerOptions.appendChild(optionBtn);
            });
        }

        function resetCodeDisplay() {
            const codeSlots = codeDisplay.querySelectorAll('div');
            codeSlots.forEach(slot => {
                slot.textContent = '?';
                slot.className = 'bg-ebd8ba rounded-lg h-16 flex items-center justify-center text-3xl font-bold';
            });
        }

        function resetCodeInputs() {
            codeInputs.forEach(input => {
                input.value = '';
            });
        }

        function updateDigitsFound() {
            digitsFound.innerHTML = '';

            if (gameData.digitsFound.length === 0) {
                const noDigits = document.createElement('p');
                noDigits.className = 'text-center text-gray-500';
                noDigits.textContent = 'Ch∆∞a t√¨m th·∫•y ch·ªØ s·ªë n√†o';
                digitsFound.appendChild(noDigits);
                return;
            }

            gameData.digitsFound.forEach(digit => {
                const digitEl = document.createElement('div');
                digitEl.className = 'bg-fac5b2 w-12 h-12 rounded-lg flex items-center justify-center text-2xl font-bold';
                digitEl.textContent = digit;
                digitsFound.appendChild(digitEl);
            });
        }

        function unlockChest() {
            // Play correct code sound
            playCorrectCodeSound();

            // Update UI
            chestPoints.textContent = gameData.currentChest.bonusPoints;

            // Add bonus points to score
            gameData.score += gameData.currentChest.bonusPoints;

            // Mark chest as completed
            gameData.currentChest.completed = true;

            // Show unlock modal
            chestUnlockedModal.classList.remove('hidden');

            // Create confetti effect
            createConfetti();
        }

        function createConfetti() {
            const confettiContainer = document.body;
            const colors = ['#c5755d', '#ebd8ba', '#fac5b2', '#8a5c39'];

            for (let i = 0; i < 100; i++) {
                const confetti = document.createElement('div');
                confetti.className = 'confetti';
                confetti.style.left = `${Math.random() * 100}%`;
                confetti.style.width = `${Math.random() * 10 + 5}px`;
                confetti.style.height = `${Math.random() * 10 + 5}px`;
                confetti.style.backgroundColor = colors[Math.floor(Math.random() * colors.length)];
                confetti.style.animationDuration = `${Math.random() * 2 + 2}s`;
                confetti.style.animationDelay = `${Math.random() * 0.5}s`;

                confettiContainer.appendChild(confetti);

                // Remove confetti after animation
                setTimeout(() => {
                    confetti.remove();
                }, 3000);
            }
        }

        function checkAllChestsCompleted() {
            const allCompleted = gameData.chests.every(chest => chest.completed);

            if (allCompleted) {
                showFinalResults();
            }
        }

        function showFinalResults() {
            // Update final score
            finalScore.textContent = `${gameData.score} ƒëi·ªÉm`;

            // Show final results modal
            finalResultsModal.classList.remove('hidden');
        }

        function startCountdown() {
            // If timer is already running, stop it
            if (timerRunning) {
                clearInterval(timerInterval);
                timerRunning = false;
                startTimer.textContent = "B·∫Øt ƒê·∫ßu ƒê·∫øm Gi·ªù";
                resetTimer();
                return;
            }

            // Reset timer
            resetTimer();

            // Play timer sound
            playTimerSound();

            // Update button text
            startTimer.textContent = "D·ª´ng ƒê·∫øm Gi·ªù";

            // Set timer running flag
            timerRunning = true;

            // Start countdown
            timerInterval = setInterval(() => {
                timeLeft--;

                // Update timer text
                timerText.textContent = timeLeft;

                // Update timer circle
                const dashoffset = 440 * (1 - timeLeft / 15);
                timerCircle.style.strokeDashoffset = dashoffset;

                // Change color as time runs out
                if (timeLeft <= 5) {
                    timerCircle.style.stroke = '#c5755d';
                }

                if (timeLeft <= 0) {
                    clearInterval(timerInterval);
                    timerRunning = false;
                    startTimer.textContent = "B·∫Øt ƒê·∫ßu ƒê·∫øm Gi·ªù";
                }
            }, 1000);
        }

        function resetTimer() {
            // Clear interval
            clearInterval(timerInterval);

            // Reset time left
            timeLeft = 15;

            // Reset timer text
            timerText.textContent = timeLeft;

            // Reset timer circle
            timerCircle.style.strokeDashoffset = 0;
            timerCircle.style.stroke = '#c5755d';

            // Reset timer running flag
            timerRunning = false;

            // Reset button text
            startTimer.textContent = "B·∫Øt ƒê·∫ßu ƒê·∫øm Gi·ªù";
        }

        function shakeElement(element) {
            element.classList.add('shake');
            setTimeout(() => {
                element.classList.remove('shake');
            }, 500);
        }

        // Event Listeners
        // Home Screen
        startGameBtn.addEventListener('click', () => {
            homeScreen.classList.add('hidden');
            chestSelection.classList.remove('hidden');
        });

        // Chest Selection
        chest1.addEventListener('click', () => {
            loadChest(1);
        });

        chest2.addEventListener('click', () => {
            loadChest(2);
        });

        chest3.addEventListener('click', () => {
            loadChest(3);
        });

        backToHome.addEventListener('click', () => {
            chestSelection.classList.add('hidden');
            homeScreen.classList.remove('hidden');
        });

        // Game Screen
        backToQuestions.addEventListener('click', () => {
            // Clear timer
            if (timerRunning) {
                clearInterval(timerInterval);
                timerRunning = false;
            }
            resetTimer();

            // Go back to questions
            questionDetail.classList.add('hidden');
            questionsContainer.parentElement.classList.remove('hidden');
        });

        checkAnswer.addEventListener('click', () => {
            // Play check answer sound
            playCheckAnswerSound();

            const questionId = parseInt(checkAnswer.dataset.questionId);
            const question = gameData.currentChest.questions.find(q => q.id === questionId);
            const selectedOption = document.querySelector('.option-btn.selected');

            // Check if an option is selected
            if (!selectedOption) {
                alert('Vui l√≤ng ch·ªçn m·ªôt ƒë√°p √°n!');
                return;
            }

            const selectedIndex = parseInt(selectedOption.dataset.index);

            // Hide check answer button
            checkAnswer.classList.add('hidden');

            // Disable options
            document.querySelectorAll('.option-btn').forEach(btn => {
                btn.disabled = true;
            });

            // Clear timer if running
            if (timerRunning) {
                clearInterval(timerInterval);
                timerRunning = false;
            }
            resetTimer();

            if (selectedIndex === question.answer) {
                // Mark question as answered
                question.answered = true;

                // Add points to score
                gameData.score += gameData.currentChest.pointsPerQuestion;

                // Get a random digit from the code that hasn't been found yet
                const availableDigits = gameData.currentChest.code.filter(digit =>
                    !gameData.digitsFound.includes(digit)
                );

                let foundDigitValue;
                if (availableDigits.length > 0) {
                    foundDigitValue = availableDigits[Math.floor(Math.random() * availableDigits.length)];
                    gameData.digitsFound.push(foundDigitValue);
                } else {
                    // If all digits are found, just show a random one again
                    foundDigitValue = gameData.currentChest.code[Math.floor(Math.random() * gameData.currentChest.code.length)];
                }

                // Update UI
                foundDigit.textContent = foundDigitValue;
                pointsEarned.textContent = gameData.currentChest.pointsPerQuestion;
                correctAnswer.classList.remove('hidden');
                wrongAnswer.classList.add('hidden');

                // Update digits found
                updateDigitsFound();
            } else {
                // Show wrong answer
                correctAnswer.classList.add('hidden');
                wrongAnswer.classList.remove('hidden');
            }

            // Show result
            answerResult.classList.remove('hidden');
        });

        continueAfterAnswer.addEventListener('click', () => {
            // Go back to questions
            questionDetail.classList.add('hidden');
            questionsContainer.parentElement.classList.remove('hidden');

            // Reload questions to update UI
            loadQuestions();
        });

        unlockChestBtn.addEventListener('click', () => {
            // Get entered code
            let enteredCode = [];
            codeInputs.forEach(input => {
                if (input.value !== '') {
                    enteredCode.push(parseInt(input.value));
                }
            });

            // Check if code is complete
            if (enteredCode.length !== 5) {
                alert('Vui l√≤ng nh·∫≠p ƒë·ªß 5 ch·ªØ s·ªë c·ªßa m√£.');
                return;
            }

            // Check if code is correct
            const correctCode = gameData.currentChest.code;
            const isCorrect = enteredCode.every((digit, index) => digit === correctCode[index]);

            if (isCorrect) {
                // Unlock chest
                unlockChest();
            } else {
                // Play wrong code sound
                playWrongCodeSound();

                // Show wrong code modal
                wrongCodeModal.classList.remove('hidden');

                // Shake the code input container
                shakeElement(document.getElementById('code-input-container'));
            }
        });

        backToChests.addEventListener('click', () => {
            // Clear timer if running
            if (timerRunning) {
                clearInterval(timerInterval);
                timerRunning = false;
            }

            // Go back to chest selection
            gameScreen.classList.add('hidden');
            chestSelection.classList.remove('hidden');
        });

        // Timer
        startTimer.addEventListener('click', () => {
            startCountdown();
        });

        // Code inputs
        codeInputs.forEach((input, index) => {
            // Limit to one digit
            input.addEventListener('input', function () {
                if (this.value.length > 1) {
                    this.value = this.value.slice(0, 1);
                }

                // Move to next input if value is entered
                if (this.value !== '' && index < codeInputs.length - 1) {
                    codeInputs[index + 1].focus();
                }
            });

            // Handle backspace
            input.addEventListener('keydown', function (e) {
                if (e.key === 'Backspace' && this.value === '' && index > 0) {
                    codeInputs[index - 1].focus();
                }
            });
        });

        // Wrong Code Modal
        tryAgainBtn.addEventListener('click', () => {
            // Hide modal
            wrongCodeModal.classList.add('hidden');

            // Clear code inputs
            resetCodeInputs();

            // Focus on first input
            codeInputs[0].focus();
        });

        // Chest Unlocked Modal
        continueAfterUnlock.addEventListener('click', () => {
            // Hide modal
            chestUnlockedModal.classList.add('hidden');

            // Go back to chest selection
            gameScreen.classList.add('hidden');
            chestSelection.classList.remove('hidden');

            // Check if all chests are completed
            checkAllChestsCompleted();
        });

        // Final Results Modal
        playAgainBtn.addEventListener('click', () => {
            // Reset game data
            gameData.score = 0;
            gameData.digitsFound = [];

            gameData.chests.forEach(chest => {
                chest.completed = false;
                chest.questions.forEach(question => {
                    question.answered = false;
                });
            });

            // Hide modal
            finalResultsModal.classList.add('hidden');

            // Go back to home
            chestSelection.classList.add('hidden');
            homeScreen.classList.remove('hidden');
        });
    </script>

</html>